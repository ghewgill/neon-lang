/*
This file is part of Natural Docs, which is Copyright © 2003-2023 Code Clear LLC.
Natural Docs is licensed under version 3 of the GNU Affero General Public
License (AGPL).  Refer to License.txt or www.naturaldocs.org for the
complete details.

This file may be distributed with documentation files generated by Natural Docs.
Such documentation is not covered by Natural Docs' copyright and licensing,
and may have its own copyright and distribution terms as decided by its author.
*/

"use strict";var NDContentPage=new function(){this.Start=function(retrying){if(!retrying){this.resizeEventHandler=NDContentPage.OnResize.bind(NDContentPage);this.messageEventHandler=NDContentPage.OnMessage.bind(NDContentPage);this.effectiveThemeChangeEventHandler=NDContentPage.OnEffectiveThemeChange.bind(NDContentPage);var themeID=NDCore.GetQueryParam('Theme');NDThemes.SetCurrentTheme(themeID,false);document.addEventListener("NDEffectiveThemeChange",this.effectiveThemeChangeEventHandler);window.addEventListener("message",this.messageEventHandler);}if(!this.CalculateWideFormPrototypeWidths()){setTimeout("NDContentPage.Start(true);",200);return;}this.ReformatPrototypes();window.addEventListener("resize",this.resizeEventHandler);this.toolTipHolder=document.createElement("div");this.toolTipHolder.style.display="none";this.toolTipHolder.style.position="fixed";this.toolTipHolder.style.zIndex=20;document.body.appendChild(this.toolTipHolder);var ttLocation=location.href;var queryIndex=ttLocation.indexOf('?');if(queryIndex!=-1){ttLocation=ttLocation.substr(0,queryIndex);}else{var hashIndex=ttLocation.indexOf('#');if(hashIndex!=-1){ttLocation=ttLocation.substr(0,hashIndex);}}ttLocation=ttLocation.substr(0,ttLocation.length-5)+"-ToolTips.js";NDCore.LoadJavaScript(ttLocation);};this.OnResize=function(event){if(this.reformatPrototypesTimeout==undefined){this.reformatPrototypesTimeout=setTimeout("NDContentPage.ReformatPrototypes()",200);}};this.OnMessage=function(event){var message=event.data;if(message=="NoTheme"){NDThemes.SetCurrentTheme(undefined,false);}else if(message.startsWith("Theme=")){var theme=message.slice(6);NDThemes.SetCurrentTheme(theme,false);}};this.OnEffectiveThemeChange=function(event){if(event.detail.oldEffectiveThemeID!=undefined){document.documentElement.classList.remove(event.detail.oldEffectiveThemeID+"Theme");}if(event.detail.newEffectiveThemeID!=undefined){document.documentElement.classList.add(event.detail.newEffectiveThemeID+"Theme");}};this.GetPrototypeIDNumber=function(element){if(element.id.indexOf("NDPrototype")==0){var id=parseInt(element.id.substr(11),10);if(id!=NaN&&id>0){return id;}}return-1;};this.CalculateWideFormPrototypeWidths=function(){var prototypes=document.getElementsByClassName("NDPrototype");for(var prototypeIndex=0;prototypeIndex<prototypes.length;prototypeIndex++){if(prototypes[prototypeIndex].classList.contains("WideForm")){var parameterSections=prototypes[prototypeIndex].getElementsByClassName("PParameterCells");var maxWidth=0;for(var parameterSectionIndex=0;parameterSectionIndex<parameterSections.length;parameterSectionIndex++){var sectionWidth=parameterSections[parameterSectionIndex].offsetWidth;if(sectionWidth>maxWidth){maxWidth=sectionWidth;}}if(maxWidth==0){return false;}prototypes[prototypeIndex].dataset.ndWideFormPrototypeWidth=maxWidth;}}return true;};this.ReformatPrototypes=function(){var prototypes=document.getElementsByClassName("NDPrototype");for(var i=0;i<prototypes.length;i++){var id=this.GetPrototypeIDNumber(prototypes[i]);if(id==-1){continue;}var wideFormWidth=prototypes[i].dataset.ndWideFormPrototypeWidth;if(wideFormWidth==null||wideFormWidth<=0){continue;}var availableWidth=prototypes[i].offsetWidth;availableWidth-=(prototypes[i].firstChild.offsetLeft-prototypes[i].offsetLeft)*2;availableWidth--;if(availableWidth>=wideFormWidth&&prototypes[i].classList.contains("NarrowForm")){NDCore.ChangePrototypeToWideForm(prototypes[i]);}else if(availableWidth<wideFormWidth&&prototypes[i].classList.contains("WideForm")){NDCore.ChangePrototypeToNarrowForm(prototypes[i]);}}if(this.reformatPrototypesTimeout!=undefined){clearTimeout(this.reformatPrototypesTimeout);this.reformatPrototypesTimeout=undefined;}};this.ShowAdditionalChildren=function(prototypeID){var prototype=document.getElementById(prototypeID);var notice=prototype.getElementsByClassName("CPAdditionalChildrenNotice")[0];var additionalChildren=prototype.getElementsByClassName("CPAdditionalChildren","div")[0];notice.style.display="none";additionalChildren.style.display="block";};this.OnToolTipsLoaded=function(toolTips){this.toolTips=toolTips;if(this.showingToolTip!=undefined&&this.toolTips[this.showingToolTip]!=undefined){this.ShowToolTip();}};this.OnLinkMouseOver=function(event,toolTipID){if(this.showingToolTip!=toolTipID){this.ResetToolTip();this.showingToolTip=toolTipID;this.domLinkShowingToolTip=event.target;if(this.toolTips==undefined){}else if(this.toolTips[toolTipID]!=undefined){this.toolTipTimeout=setTimeout(function(){clearTimeout(this.toolTipTimeout);this.toolTipTimeout=undefined;NDContentPage.ShowToolTip();},350);}}};this.OnLinkMouseOut=function(event){if(this.domLinkShowingToolTip==event.target){this.ResetToolTip();}};this.ShowToolTip=function(){this.toolTipHolder.innerHTML=this.toolTips[this.showingToolTip];this.toolTipHolder.style.visibility="hidden";this.toolTipHolder.style.display="block";this.toolTipHolder.style.left="0px";var scrollParent=document.body;if(scrollParent.scrollTop==0){scrollParent=scrollParent.parentNode;}var linkOffsets=NDCore.GetFullOffsets(this.domLinkShowingToolTip);var x=linkOffsets.offsetLeft-8;var y=linkOffsets.offsetTop+this.domLinkShowingToolTip.offsetHeight-scrollParent.scrollTop+3;var newWidth=undefined;if(x<5){x=5;}if(x+this.toolTipHolder.offsetWidth+5>document.body.offsetWidth){x=document.body.offsetWidth-this.toolTipHolder.offsetWidth-5;if(x<5){x=5;newWidth=document.body.offsetWidth-10;}}this.toolTipHolder.style.left=x+"px";this.toolTipHolder.style.top=y+"px";if(newWidth!=undefined){this.toolTipHolder.style.width=newWidth+"px";}var prototypes=this.toolTipHolder.getElementsByClassName("NDPrototype");if(prototypes.length>0&&prototypes[0].classList.contains("WideForm")&&prototypes[0].scrollWidth>prototypes[0].offsetWidth){NDCore.ChangePrototypeToNarrowForm(prototypes[0]);}if(y+this.toolTipHolder.offsetHeight+25>document.body.parentNode.offsetHeight){var newY=linkOffsets.offsetTop-this.toolTipHolder.offsetHeight-scrollParent.scrollTop-3;if(newY>=3){this.toolTipHolder.style.top=newY+"px";}}this.toolTipHolder.style.visibility="visible";};this.ResetToolTip=function(){if(this.showingToolTip!=undefined){this.toolTipHolder.style.display="none";this.toolTipHolder.style.width=null;this.lastToolTip=this.showingToolTip;this.showingToolTip=undefined;}if(this.toolTipTimeout!=undefined){clearTimeout(this.toolTipTimeout);this.toolTipTimeout=undefined;}};};