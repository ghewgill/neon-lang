language: cpp
os:
  - linux
  #- osx
osx_image: xcode6.4
compiler:
  - gcc
  # It seems that the clang compiler on travis doesn't correctly build its own headers.
  #- clang
env:
  - MINIMAL=1 RELEASE=0
  #- MINIMAL=1 RELEASE=1
  #- MINIMAL=0 RELEASE=0
  #- MINIMAL=0 RELEASE=1
before_install:
  - which scons || brew install scons
script: scons MINIMAL=$MINIMAL RELEASE=$RELEASE COVERAGE=1
after_success:
  - for fn in src/*.cpp lib/*.cpp tests/*.cpp; do echo gcov -o $fn; gcov -o $fn; done
  - bash <(curl -s https://codecov.io/bash)
sudo: false
