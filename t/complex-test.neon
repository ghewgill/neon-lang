IMPORT complex
IMPORT math

FUNCTION eq(x: Number, y: Number): Boolean
    RETURN math.abs(math.abs(x - y) / y) < 1e-14
END FUNCTION

FUNCTION eq2(x: complex.Complex, re, im: Number): Boolean
    RETURN eq(x.re, re) AND eq(x.im, im)
END FUNCTION

LET a: complex.Complex := complex.make(5, -1)
LET b: complex.Complex := complex.make(3, 2)

TESTCASE eq2(a, 5, -1)

-- Expected results taken from Wolfram Alpha,
-- rounded to precision of decimal128 (there are
-- some minor differences in the least significant
-- digit - this is a gross test of the complex
-- library, not a detailed test of decimal128).

TESTCASE eq2(a.acos(), 0.2011950797009102153258743715717534, 2.313220941769529089460728645235202)
TESTCASE eq(a.abs(), 5.099019513592784830028224109022782)
TESTCASE eq2(a.add(b), 8, 1)
TESTCASE eq(a.arg(), -0.1973955598498807583700497651947903)
TESTCASE eq2(a.asin(), 1.369601247093986403905447320067998, -2.313220941769529089460728645235202)
TESTCASE eq2(a.asinh(), 2.330974653049312417443624491578674, -0.1937931365549321897823490221655913)
TESTCASE eq2(a.atan(), 1.380543138238714176079527733234535, -3.710500127956831949543834147738405e-2)
TESTCASE eq2(a.atanh(), 0.1944261421470020910296402632895803, -1.530881333938777961284844595856086)
TESTCASE eq2(a.cos(), 0.4377136252176745997469742573700928, -1.126928952198136846835438279509058)
TESTCASE eq2(a.cosh(), 40.09580630629882572977934560180841, -62.43984868079963016871854053588014)
TESTCASE eq2(a.div(b), 1, -1)
TESTCASE eq2(a.exp(), 80.1879720842972282693907285426327, -124.8853671484961641963775578906394)
TESTCASE eq2(a.exp10(), -66820.15101903129462423306966561422, -74398.03369574931876584164068755146)
TESTCASE eq2(a.inv(), 0.1923076923076923076923076923076923, 3.846153846153846153846153846153846e-2)
TESTCASE eq2(a.log(), 1.629048269010741022735359781511748, -0.1973955598498807583700497651947903)
TESTCASE eq2(a.log10(), 0.707486673985408982210122026333411, -8.572780239500630207282976693332719e-2)
TESTCASE eq2(a.mul(b), 17, 7)
TESTCASE eq2(a.pow(b), -174.9072200903553382196675856127167, 90.10096978333362945892916585497655)
TESTCASE eq2(a.sin(), -1.479697478486942893959999962770578, -0.3333601389479928918937933307373614)
TESTCASE eq2(a.sinh(), 40.09216577799840253961138294082429, -62.44551846769653402765901735475928)
TESTCASE eq2(a.sqrt(), 2.247111425095870143601116925049075, -0.2225078803017826041105584987993255)
TESTCASE eq2(a.sub(b), 2, -3)
TESTCASE eq2(a.square(), 24, -10)
TESTCASE eq2(a.tan(), -0.1861094776473041695262396107291072, -1.240747982924069658056894364944718)
TESTCASE eq2(a.tanh(), 1.000037783379600707736515647777321, -8.256719834229596046246218755895908e-5)
